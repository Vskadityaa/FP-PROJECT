<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Scan Result</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js"></script>
</head>
<body>
    <main class="container">
        <h1 class="title">Pet Details</h1>
        <div id="pet-info">
            <p><strong>Pet Name:</strong> <span id="petName"></span></p>
            <p><strong>Owner Name:</strong> <span id="ownerName"></span></p>
            <p><strong>Phone:</strong> <span id="phone"></span></p>
            <p><strong>Breed:</strong> <span id="petBreed"></span></p>
            <p><strong>Color:</strong> <span id="petColor"></span></p>
            <p><strong>Address:</strong> <span id="address"></span></p>
            <p><strong>Scanned Count:</strong> <span id="scanCount"></span></p>
        </div>
    </main>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBHrBpHNePrpVG8Z5ahCY8Av8Y4A-6t9Ac",
            authDomain: "pet-registration-e9d6f.firebaseapp.com",
            databaseURL: "https://pet-registration-e9d6f-default-rtdb.firebaseio.com",
            projectId: "pet-registration-e9d6f",
            storageBucket: "pet-registration-e9d6f.appspot.com",
            messagingSenderId: "220116952151",
            appId: "1:220116952151:web:88565249899c7a60e9ef12"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Extract petId from URL
        const urlParams = new URLSearchParams(window.location.search);
        const petId = urlParams.get("petId");

        if (petId) {
            const petRef = db.ref("pets/" + petId);

            petRef.once("value").then((snapshot) => {
                if (snapshot.exists()) {
                    const petData = snapshot.val();
                    
                    // Display pet details
                    document.getElementById("petName").textContent = petData.petName;
                    document.getElementById("ownerName").textContent = petData.ownerName;
                    document.getElementById("phone").textContent = petData.phone;
                    document.getElementById("petBreed").textContent = petData.petBreed;
                    document.getElementById("petColor").textContent = petData.petColor;
                    document.getElementById("address").textContent = petData.address;
                    document.getElementById("scanCount").textContent = petData.scanCount || 0;

                    // Update scan count
                    petRef.update({ scanCount: (petData.scanCount || 0) + 1 });
                } else {
                    document.body.innerHTML = "<h2>Pet not found!</h2>";
                }
            }).catch((error) => {
                console.error("Error fetching pet data:", error);
                document.body.innerHTML = "<h2>Error fetching pet data</h2>";
            });
        } else {
            document.body.innerHTML = "<h2>Invalid scan</h2>";
        }
    </script>
</body>
</html>
